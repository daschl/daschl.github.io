<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo 0.42.2" />


<title>Bootstrapping from DNS SRV records in Java - daschl writes. sometimes.</title>
<meta property="og:title" content="Bootstrapping from DNS SRV records in Java - daschl writes. sometimes.">



  
  <meta property="description" content="See how to load hostnames in your Java application from DNS SRV records.">
  






<link rel="stylesheet" href="https://nitschinger.at/css/main.css" media="all">
<link rel="stylesheet" href="https://nitschinger.at/css/fonts.css">

  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav">
  <a href="https://nitschinger.at/" class="nav-title">
    daschl blogs. sometimes.
  </a>

  <ul class="nav-links">
    
    <li>
      <a href="/tags">tags</a>
    </li>
    
    <li>
      <a href="/imprint/">imprint</a>
    </li>
    
    <li>
      <a href="https://twitter.com/daschl">-&gt; twitter</a>
    </li>
    
    <li>
      <a href="https://github.com/daschl">-&gt; github</a>
    </li>
    
  </ul>
</nav>
      </header>


<main class="content" role="main">
  <article class="article">
    <h1 class="article-title">Bootstrapping from DNS SRV records in Java</h1>
    
    <span class="article-date">2014-01-29</span>
    

    <div class="article-content">
      <p>I know this topic has a very narrow audience, but I hope that one or two people out there scratching their heads will benefit from it.</p>

<p>Here&rsquo;s the itch we&rsquo;re trying to scratch: is there an easy way to determine hostnames for - let&rsquo;s say - a database connection? There are many ways to do this, like hardcoding it, providing them through a properties file and so on. All this techniques (maybe aside from fetching it over the network from a central storage) require some modifications on the server once one of the hostnames changes. If you need to maintain a lot of machines, this can get inefficient pretty quickly.</p>

<p>Now let&rsquo;s step back a second and think about what we&rsquo;re using anyway in our infrastructure: DNS. Until recently I haven&rsquo;t heard of the SRV record that you can use to &ldquo;refer&rdquo; to other hostnames. The nice thing about this is that you can provide more endpoints and even add weights and and priorities. Let&rsquo;s look at an example:</p>

<pre><code>_cbnodes._tcp.example.com.  0  IN  SRV  20  0  8091  node2.example.com.
_cbnodes._tcp.example.com.  0  IN  SRV  10  0  8091  node1.example.com.
_cbnodes._tcp.example.com.  0  IN  SRV  30  0  8091  node3.example.com.
</code></pre>

<p>Here, based on the &ldquo;_cbnodes._tcp.example.com.&rdquo; service information we get to know that there are three nodes configured that belong to this service. They all listen on port <code>8091</code>, but have priorities associated with them (10, 20, 30). Lower priorities are considered more important, so you can use that to your advantage. The <code>0</code> between the priority and the port is the weight. You can use different weights (which are probabilities) to generate some kind of load-balancing behaviour.</p>

<p>Once this is configured on the DNS server, we can make use of that in our application. Say we want to infer the seed nodes to bootstrap from in our <code>CouchbaseClient</code>. To make this happen, we need to make use of <a href="http://en.wikipedia.org/wiki/Java_Naming_and_Directory_Interface">JNDI</a>. Let&rsquo;s first create a simple class that will hold those records shown above:</p>
<div class="highlight"><div style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">59
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#6ab825;font-weight:bold">static</span> <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf">DnsRecord</span> <span style="color:#6ab825;font-weight:bold">implements</span> Comparable&lt;DnsRecord&gt; {
    <span style="color:#6ab825;font-weight:bold">private</span> <span style="color:#6ab825;font-weight:bold">final</span> <span style="color:#6ab825;font-weight:bold">int</span> priority;
    <span style="color:#6ab825;font-weight:bold">private</span> <span style="color:#6ab825;font-weight:bold">final</span> <span style="color:#6ab825;font-weight:bold">int</span> weight;
    <span style="color:#6ab825;font-weight:bold">private</span> <span style="color:#6ab825;font-weight:bold">final</span> <span style="color:#6ab825;font-weight:bold">int</span> port;
    <span style="color:#6ab825;font-weight:bold">private</span> <span style="color:#6ab825;font-weight:bold">final</span> String host;

    <span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#447fcf">DnsRecord</span>(<span style="color:#6ab825;font-weight:bold">int</span> priority, <span style="color:#6ab825;font-weight:bold">int</span> weight, <span style="color:#6ab825;font-weight:bold">int</span> port, String host) {
      <span style="color:#6ab825;font-weight:bold">this</span>.<span style="color:#bbb">priority</span> = priority;
      <span style="color:#6ab825;font-weight:bold">this</span>.<span style="color:#bbb">weight</span> = weight;
      <span style="color:#6ab825;font-weight:bold">this</span>.<span style="color:#bbb">port</span> = port;
      <span style="color:#6ab825;font-weight:bold">this</span>.<span style="color:#bbb">host</span> = host.<span style="color:#bbb">replaceAll</span>(<span style="color:#ed9d13">&#34;\\\\.$&#34;</span>, <span style="color:#ed9d13">&#34;&#34;</span>);
    }

    <span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">int</span> <span style="color:#447fcf">getPriority</span>() {
      <span style="color:#6ab825;font-weight:bold">return</span> priority;
    }

    <span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">int</span> <span style="color:#447fcf">getWeight</span>() {
      <span style="color:#6ab825;font-weight:bold">return</span> weight;
    }

    <span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">int</span> <span style="color:#447fcf">getPort</span>() {
      <span style="color:#6ab825;font-weight:bold">return</span> port;
    }

    <span style="color:#6ab825;font-weight:bold">public</span> String <span style="color:#447fcf">getHost</span>() {
      <span style="color:#6ab825;font-weight:bold">return</span> host;
    }

    <span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">static</span> DnsRecord <span style="color:#447fcf">fromString</span>(String input) {
      String[] splitted = input.<span style="color:#bbb">split</span>(<span style="color:#ed9d13">&#34; &#34;</span>);
      <span style="color:#6ab825;font-weight:bold">return</span> <span style="color:#6ab825;font-weight:bold">new</span> DnsRecord(
        Integer.<span style="color:#bbb">parseInt</span>(splitted[0]),
        Integer.<span style="color:#bbb">parseInt</span>(splitted[1]),
        Integer.<span style="color:#bbb">parseInt</span>(splitted[2]),
        splitted[3]
      );
    }

    <span style="color:#ffa500">@Override</span>
    <span style="color:#6ab825;font-weight:bold">public</span> String <span style="color:#447fcf">toString</span>() {
      <span style="color:#6ab825;font-weight:bold">return</span> <span style="color:#ed9d13">&#34;DnsRecord{&#34;</span> +
        <span style="color:#ed9d13">&#34;priority=&#34;</span> + priority +
        <span style="color:#ed9d13">&#34;, weight=&#34;</span> + weight +
        <span style="color:#ed9d13">&#34;, port=&#34;</span> + port +
        <span style="color:#ed9d13">&#34;, host=&#39;&#34;</span> + host + <span style="color:#ed9d13">&#39;\\&#39;</span><span style="color:#a61717;background-color:#e3d2d2">&#39;</span> +
        <span style="color:#ed9d13">&#39;}&#39;</span>;
    }

    <span style="color:#ffa500">@Override</span>
    <span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">int</span> <span style="color:#447fcf">compareTo</span>(DnsRecord o) {
      <span style="color:#6ab825;font-weight:bold">if</span> (getPriority() &lt; o.<span style="color:#bbb">getPriority</span>()) {
        <span style="color:#6ab825;font-weight:bold">return</span> -1;
      } <span style="color:#6ab825;font-weight:bold">else</span> {
        <span style="color:#6ab825;font-weight:bold">return</span> 1;
      }
    }

}</code></pre></td></tr></table>
</div>
</div>
<p>We provide a custom <code>compareTo</code> method in order to automatically sort each <code>DnsRecord</code> by priority. The next step is to write a method that allows us to fetch the actual information:</p>
<div class="highlight"><div style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">String service = <span style="color:#ed9d13">&#34;_cbnodes._tcp.example.com&#34;</span>;

Hashtable&lt;String, String&gt; env = <span style="color:#6ab825;font-weight:bold">new</span> Hashtable&lt;String, String&gt;();
env.<span style="color:#bbb">put</span>(<span style="color:#ed9d13">&#34;java.naming.factory.initial&#34;</span>, <span style="color:#ed9d13">&#34;com.sun.jndi.dns.DnsContextFactory&#34;</span>);
  env.<span style="color:#bbb">put</span>(<span style="color:#ed9d13">&#34;java.naming.provider.url&#34;</span>, <span style="color:#ed9d13">&#34;dns:&#34;</span>);
DirContext ctx = <span style="color:#6ab825;font-weight:bold">new</span> InitialDirContext(env);
Attributes attrs = ctx.<span style="color:#bbb">getAttributes</span>(service, <span style="color:#6ab825;font-weight:bold">new</span> String[] { <span style="color:#ed9d13">&#34;SRV&#34;</span> });

  NamingEnumeration&lt;?&gt; servers = attrs.<span style="color:#bbb">get</span>(<span style="color:#ed9d13">&#34;srv&#34;</span>).<span style="color:#bbb">getAll</span>();
  Set&lt;DnsRecord&gt; sortedRecords = <span style="color:#6ab825;font-weight:bold">new</span> TreeSet&lt;DnsRecord&gt;();
  <span style="color:#6ab825;font-weight:bold">while</span> (servers.<span style="color:#bbb">hasMore</span>()) {
    DnsRecord record = DnsRecord.<span style="color:#bbb">fromString</span>((String) servers.<span style="color:#bbb">next</span>());
    sortedRecords.<span style="color:#bbb">add</span>(record);
  }</code></pre></td></tr></table>
</div>
</div>
<p>Now we have a <code>Set</code> of sorted <code>DnsRecords</code>, which we can use however we want to. For example, with <a href="http://couchbase.com">Couchbase</a> we can turn them into <code>URI</code>s:</p>
<div class="highlight"><div style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">List&lt;URI&gt; uris = <span style="color:#6ab825;font-weight:bold">new</span> ArrayList&lt;URI&gt;();
<span style="color:#6ab825;font-weight:bold">for</span>(DnsRecord record : sortedRecords) {
	uris.<span style="color:#bbb">add</span>(<span style="color:#6ab825;font-weight:bold">new</span> URI(<span style="color:#ed9d13">&#34;http://&#34;</span> + record.<span style="color:#bbb">getHost</span>() + <span style="color:#ed9d13">&#34;:&#34;</span> + record.<span style="color:#bbb">getPort</span>() + <span style="color:#ed9d13">&#34;/pools&#34;</span>));
}</code></pre></td></tr></table>
</div>
</div>
<p>If you want to play around with the code and don&rsquo;t have DNS SRV records set up, I recommend you to use <code>_xmpp-server._tcp.gmail.com</code>. It exposes Googles GMail XMPP servers and lets
you try the code without much effort. In case you wonder how to mock that thing correctly, I recommend you to mock the <code>DirContext</code> like so:</p>
<div class="highlight"><div style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">String service = <span style="color:#ed9d13">&#34;_seeds._tcp.couchbase.com&#34;</span>;

BasicAttributes basicAttributes = <span style="color:#6ab825;font-weight:bold">new</span> BasicAttributes(<span style="color:#6ab825;font-weight:bold">true</span>);
BasicAttribute basicAttribute = <span style="color:#6ab825;font-weight:bold">new</span> BasicAttribute(<span style="color:#ed9d13">&#34;SRV&#34;</span>);
basicAttribute.<span style="color:#bbb">add</span>(<span style="color:#ed9d13">&#34;20 0 8091 node2.couchbase.com.&#34;</span>);
basicAttribute.<span style="color:#bbb">add</span>(<span style="color:#ed9d13">&#34;10 0 8091 node1.couchbase.com.&#34;</span>);
basicAttribute.<span style="color:#bbb">add</span>(<span style="color:#ed9d13">&#34;30 0 8091 node3.couchbase.com.&#34;</span>);
basicAttribute.<span style="color:#bbb">add</span>(<span style="color:#ed9d13">&#34;40 0 8091 node4.couchbase.com.&#34;</span>);
basicAttributes.<span style="color:#bbb">put</span>(basicAttribute);

DirContext mockedContext = mock(DirContext.<span style="color:#bbb">class</span>);
when(mockedContext.<span style="color:#bbb">getAttributes</span>(service, <span style="color:#6ab825;font-weight:bold">new</span> String[] { <span style="color:#ed9d13">&#34;SRV&#34;</span> }))
  .<span style="color:#bbb">thenReturn</span>(basicAttributes);</code></pre></td></tr></table>
</div>
</div>
<p>The code shown here (and more advanced features) are part of the official Couchbase SDK, so check out the <a href="https://github.com/couchbase/couchbase-java-client">codebase</a> if you want to learn more!</p>

    </div>
 
    <ul class="article-taxonomy">
      
    
      
      <li>
        <i class="fa fa-tags"></i><a href="/tags/java">java</a><a href="/tags/couchbase">couchbase</a><a href="/tags/dns">dns</a>
      </li>
      
  </article>

</main>

<footer class="footer">
  <ul class="footer-links">
    <li>
      <a href="https://nitschinger.at/index.xml" type="application/rss+xml" target="_blank">
        <i class="fa fa-rss"></i> RSS feed</a>
    </li>
    <li>
      <a href="https://github.com/mobybit/hugo-natrium-theme">
        <i class="fa fa-github"></i> Built with Hugo &amp; Natrium Theme</a>
    </li>
  </ul>
</footer>

</div>

</body>

</html>
